.\" process with:
.\" groff -man -Tascii rsa.1 | less

.TH "rsa" "1" "" "Ilan A. Smith" "Encryption Utilities"
.SH "NAME"
.LP
rsa \- an RSA encrypter/RSA key generator and decrypter

.SH "SYNTAX"
.LP
rsa [ COMMON OPTIONS ]
.br
rsa [\-e|\-\-encrypt] [ ENCRYPTION OPTIONS ]
.br
rsa [\-d|\-\-decrypt] [ DECRYPTION OPTIONS ]

.SH "DESCRIPTION"
.LP
The rsa utility encrypts and decrypts data using the RSA public key crypto
system. It is a master utility (combines both functionalities of rsa_enc and
rsa_dec) built by compiling with MASTER=y.

.br
Two encryption modes are available:
.br
.IP
Full encryption \- the entire contents of the encrypted file is encrypted by
RSA processing (modular exponentiation). Encryption and decryption are fairly
slow. Electronic Codebook (ECB) and Cipher Block Chaining (CBC) cipher modes
are supported.
.br
.IP
Quick encryption \- encryption will be done by xoring the file's contents with
the values of a sequence generated by a pseudo random number generator (RNG)
initiated by some random seed. Only the seed itself gets encrypted by RSA
processing. As the name suggests, encryption and decryption are are quick.
.SH "OPTIONS"
.LP
.TP
\fB\-h \-\-help\fR
Output help information and exit.
.TP
\fB\-s \-\-scan\fR
Scans the key directory and outputs the available keys.
.TP
\fB\-x[key] \-\-default[=key]\fR
Set the default Keys. \fIkey\fR is the key name output by the \-\-scan option.
If \fIkey\fR is not provided no default keys are set. Otherwise, both public
and private keys identified by \fIkey\fR are set as default keys (if they
exist).
.TP
\fB\-p \-\-path\fR
Output the path where new RSA keys are to be generated and where existing keys are
to be searched. If RSA_KEYPATH is set then its value is returned, otherwise it
is the current working directory.
.TP
\fB\-q \-\-quiet\fR
Provide minimal output.
.TP
\fB\-v \-\-verbose\fR
Provide verbose output.
.TP
\fB\-f <name> \-\-file=<name>\fR
\fIname\fR is the file to encrypt/decrypt.
.TP
\fB\-e \-\-encrypt\fR
Encrypt the file stated by the \-\-file switch. The \-\-level, \-\-rsa and
\-\-key switches imply the \-\-encrypt switch.
.TP
\fB\-l <lev> \-\-level=<lev>\fR
Set the encryption level to \fIlev\fR. Supported encryption levels are:
128(default), 256, 512 and 1024 bits. This option is only available with the
\-\-encrypt switch when determining how the data is to be encrypted. Upon
decrypting (using the \-\-decrypt switch) the encryption level is determined
from the cypher text header.
.TP
\fB\-r \-\-rsa\fR
Set full RSA encryption mode. By default, quick RSA encryption mode is used.
This option is only available with the \-\-encrypt switch when determining
how the data is to be encrypted. When decrypting, the encryption mode is
determined from the cypher text header.
.TP
\fB\-c \-\-cbc\fR
Set the cipher mode to CBC. By default, ECB cipher mode is used.
This option is only available with the \-\-encrypt switch when determining
how the data is to be encrypted. When decrypting, the cipher mode is
determined from the cypher text header.
.TP
\fB\-k <curr> \-\-key=<curr>\fR
Use the public key \fIcurr\fR for the current encryption. This option overrides
the default key if it has been set.
.TP
\fB\-d \-\-decrypt\fR
Decrypt the file stated by the \-\-file switch.
.TP
\fB\-o \-\-original\fR
Keep the file/cypher text after it has been encrypted/decrypted. Encryption of
file \fIname\fR will produce the cypher text \fIname.enc\fR. If the switch is
not set, the file \fIname\fR will be deleted once it has been encrypted.
Likewise, decryption of the cypher text \fIname.enc\fR will produce the file
\fIname\fR. If the switch is not set, the cypher text \fIname.enc\fR will be
deleted once it has been decrypted.
.TP
\fB\-g <key\-name> \-\-generate=<key\-name>\fR
Generate a public/private key pair identified (by the \-\-scan, \-\-default and
the \-\-key switches) as \fIkey\-name\fR. The new pair is placed in the default
RSA key directory if set by the RSA_KEYPATH environment variable, otherwise in
the current working directory. The maximum length allowed for \fIkey\-name\fR
is 15 characters. The generated public and private keys are normally named
\fIkey\-name.pub\fR and \fIkey\-name.prv\fR respectively. A different RSA key
pair is produced for each of the different encryption levels and in each case,
one of the keys is inserted in the public key file, and the other in the
private key file. Which of the different encryption level pairs is used during
encryption is determined by setting the encryption level when encrypting. This
information is stored in the cypher text header, later to be used during
decryption.
.TP
\fB\-i \-\-info\fR
Output information regarding the encrypted file stated by the \-\-file switch.
The information reported consists of the encryption method, encryption
key\-name and the encryption level.
.SH "ENVIRONMENT VARIABLES"
.LP
.TP
\fBRSA_KEYPATH\fP
Specifies the directory where new RSA key pairs are to be generated and where
existing keys searched and scanned.
.SH "AUTHOR"
.LP
Ilan A. Smith <lunnys@gmail.com>
.SH "SEE ALSO"
.LP
rsa_enc(1) rsa_dec(1)
